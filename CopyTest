
    
# Function to perform NSLookup and retrieve IP addresses
function Get-IPAddress {
    param (
        [string]$deviceName
    )
    $ipAddress = $null
    try {
        $result = Resolve-DnsName -Name $deviceName -ErrorAction Stop
        $ipAddress = $result.IPAddress
    } catch {
        Write-Warning "Failed to resolve IP address for $deviceName"
    }
    return $ipAddress
}

# Path to the text file containing device names (each device name on a new line)
$devicesFile = "devices.txt"

# Read device names from the text file
$deviceNames = Get-Content $devicesFile

# Create Excel object
$excel = New-Object -ComObject Excel.Application
$workbook = $excel.Workbooks.Add()
$sheet = $workbook.Worksheets.Item(1)
$sheet.Cells.Item(1,1) = "Device Name"
$sheet.Cells.Item(1,2) = "IP Address"

# Populate Excel with results
$row = 2
foreach ($device in $deviceNames) {
    $ip = Get-IPAddress $device
    $sheet.Cells.Item($row, 1) = $device
    $sheet.Cells.Item($row, 2) = $ip
    $row++
}

# Save Excel file
$excelFile = "Device_IPs.xlsx"
$workbook.SaveAs($excelFile)
$workbook.Close()
$excel.Quit()

Write-Host "Excel file created: $excelFile"